<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabic TTS API Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        .endpoint {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            margin-right: 10px;
        }
        .get { background: #28a745; color: white; }
        .post { background: #007bff; color: white; }
        .websocket { background: #6f42c1; color: white; }
        .url {
            font-family: 'Courier New', monospace;
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        .feature-card h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        .nav-links {
            background: #3498db;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            margin-right: 20px;
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            transition: background 0.3s;
        }
        .nav-links a:hover {
            background: rgba(255,255,255,0.3);
        }
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé§ Arabic TTS API Documentation</h1>
        
        <div class="nav-links">
            <a href="/">üè† Home</a>
            <a href="/health">üè• Health Check</a>
            <a href="/streaming-client">üéµ Streaming Client</a>
            <a href="/docs">üìÑ Raw Documentation</a>
        </div>

        <h2>üìã Overview</h2>
        <p>This API provides Arabic Text-to-Speech (TTS) functionality using the XTTS v2 model (EGTTS-V0.1). It supports both traditional REST API endpoints and real-time WebSocket streaming for low-latency audio generation.</p>
        
        <div class="feature-list">
            <div class="feature-card">
                <h4>üéØ Word-Level Streaming</h4>
                <p>Text is processed word-by-word for natural speech flow and better pronunciation.</p>
            </div>
            <div class="feature-card">
                <h4>‚ö° Real-Time Processing</h4>
                <p>WebSocket streaming provides low-latency audio generation with immediate playback.</p>
            </div>
            <div class="feature-card">
                <h4>üé® Flexible Configuration</h4>
                <p>Customizable temperature, chunk sizes, and optional speaker files for personalized voices.</p>
            </div>
            <div class="feature-card">
                <h4>üöÄ CUDA Acceleration</h4>
                <p>GPU-accelerated processing for fast audio generation and high-quality output.</p>
            </div>
        </div>

        <h2>üîó Base URL</h2>
        <p><code>http://localhost:8000</code></p>

        <h2>üè• Health Check</h2>
        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="url">/health</span>
            <p>Check if the API server is running and CUDA is available.</p>
            
            <h4>Response:</h4>
            <pre>{
  "status": "healthy",
  "cuda_available": true
}</pre>
            
            <h4>Example:</h4>
            <pre>curl http://localhost:8000/health</pre>
        </div>

        <h2>üé§ Regular TTS Endpoint</h2>
        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="url">/tts</span>
            <p>Generate Arabic speech from text using traditional REST API.</p>
            
            <h4>Request Body:</h4>
            <pre>{
  "text": "ŸÖÿ±ÿ≠ÿ®ÿß ÿ®ŸÉ ŸÅŸä ŸÜÿ∏ÿßŸÖ ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÜÿµ ÿ•ŸÑŸâ ŸÉŸÑÿßŸÖ",
  "temperature": 0.6,
  "language": "ar",
  "chunk_size": 10,
  "speaker_file": "optional_speaker.mp3"
}</pre>

            <h4>Parameters:</h4>
            <table>
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Required</th>
                    <th>Default</th>
                    <th>Range</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><code>text</code></td>
                    <td>string</td>
                    <td><span class="status-badge success">‚úÖ</span></td>
                    <td>-</td>
                    <td>-</td>
                    <td>Arabic text to convert to speech</td>
                </tr>
                <tr>
                    <td><code>temperature</code></td>
                    <td>float</td>
                    <td><span class="status-badge error">‚ùå</span></td>
                    <td>0.6</td>
                    <td>0.0-1.0</td>
                    <td>Voice variation control</td>
                </tr>
                <tr>
                    <td><code>language</code></td>
                    <td>string</td>
                    <td><span class="status-badge error">‚ùå</span></td>
                    <td>"ar"</td>
                    <td>-</td>
                    <td>Language code (Arabic)</td>
                </tr>
                <tr>
                    <td><code>chunk_size</code></td>
                    <td>integer</td>
                    <td><span class="status-badge error">‚ùå</span></td>
                    <td>10</td>
                    <td>3-50</td>
                    <td>Maximum words per chunk</td>
                </tr>
                <tr>
                    <td><code>speaker_file</code></td>
                    <td>string</td>
                    <td><span class="status-badge error">‚ùå</span></td>
                    <td>null</td>
                    <td>-</td>
                    <td>Optional speaker reference file</td>
                </tr>
            </table>

            <h4>Success Response (200):</h4>
            <pre>{
  "success": true,
  "message": "TTS generation completed successfully",
  "audio_file": "arabic_tts_output.wav",
  "processing_time": 2.45,
  "chunks_processed": 3
}</pre>

            <h4>Error Response (400/500):</h4>
            <pre>{
  "success": false,
  "message": "Error message describing what went wrong"
}</pre>
        </div>

        <h2>üîÑ WebSocket Streaming</h2>
        <div class="endpoint">
            <span class="method websocket">WS</span>
            <span class="url">/ws/tts-stream</span>
            <p>Real-time streaming TTS with word-level processing for low latency.</p>
            
            <h4>Connection:</h4>
            <pre>const ws = new WebSocket('ws://localhost:8000/ws/tts-stream');</pre>

            <h4>Client ‚Üí Server (Configuration):</h4>
            <pre>{
  "text": "ŸÖÿ±ÿ≠ÿ®ÿß ÿ®ŸÉ ŸÅŸä ŸÜÿ∏ÿßŸÖ ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÜÿµ ÿ•ŸÑŸâ ŸÉŸÑÿßŸÖ",
  "temperature": 0.6,
  "language": "ar",
  "chunk_size": 5,
  "speaker_file": "optional_speaker.mp3",
  "stream_chunk_size": 1024
}</pre>

            <h4>Server ‚Üí Client (Audio Chunk):</h4>
            <pre>{
  "type": "audio_chunk",
  "chunk_index": 0,
  "audio_chunk_index": 0,
  "audio_data": "base64_encoded_audio_chunk",
  "total_chunks": 3,
  "total_audio_chunks": 150
}</pre>

            <h4>Parameters:</h4>
            <table>
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Required</th>
                    <th>Default</th>
                    <th>Range</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><code>text</code></td>
                    <td>string</td>
                    <td><span class="status-badge success">‚úÖ</span></td>
                    <td>-</td>
                    <td>-</td>
                    <td>Arabic text to convert to speech</td>
                </tr>
                <tr>
                    <td><code>chunk_size</code></td>
                    <td>integer</td>
                    <td><span class="status-badge error">‚ùå</span></td>
                    <td>5</td>
                    <td>2-20</td>
                    <td>Maximum words per chunk</td>
                </tr>
                <tr>
                    <td><code>stream_chunk_size</code></td>
                    <td>integer</td>
                    <td><span class="status-badge error">‚ùå</span></td>
                    <td>1024</td>
                    <td>512-4096</td>
                    <td>Audio chunk size for streaming</td>
                </tr>
            </table>
        </div>

        <h2>üìÅ Static Files</h2>
        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="url">/streaming-client</span>
            <p>Serve the HTML streaming client interface.</p>
            <p><strong>Browser Access:</strong> <a href="/streaming-client">http://localhost:8000/streaming-client</a></p>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="url">/docs</span>
            <p>Serve the raw API documentation in Markdown format.</p>
            <p><strong>Access:</strong> <a href="/docs">http://localhost:8000/docs</a></p>
        </div>

        <h2>‚ö†Ô∏è Error Handling</h2>
        <h3>HTTP Status Codes</h3>
        <table>
            <tr>
                <th>Code</th>
                <th>Description</th>
            </tr>
            <tr><td>200</td><td>Success</td></tr>
            <tr><td>400</td><td>Bad Request (invalid parameters)</td></tr>
            <tr><td>404</td><td>Not Found (endpoint doesn't exist)</td></tr>
            <tr><td>500</td><td>Internal Server Error</td></tr>
        </table>

        <h3>Common Errors</h3>
        <div class="feature-list">
            <div class="feature-card">
                <h4>Model Not Found</h4>
                <pre>{
  "success": false,
  "message": "Model files not found. Please ensure the model is properly downloaded."
}</pre>
            </div>
            <div class="feature-card">
                <h4>Invalid Parameters</h4>
                <pre>{
  "success": false,
  "message": "Invalid temperature value. Must be between 0.0 and 1.0"
}</pre>
            </div>
            <div class="feature-card">
                <h4>Speaker File Not Found</h4>
                <pre>{
  "success": false,
  "message": "Speaker file not found: speaker.mp3"
}</pre>
            </div>
            <div class="feature-card">
                <h4>CUDA Not Available</h4>
                <pre>{
  "success": false,
  "message": "CUDA is not available. Please ensure CUDA is properly installed."
}</pre>
            </div>
        </div>

        <h2>üîß Configuration</h2>
        <h3>Performance Tips</h3>
        <div class="feature-list">
            <div class="feature-card">
                <h4>For Speed</h4>
                <pre>{
  "chunk_size": 3,
  "temperature": 0.6,
  "stream_chunk_size": 2048
}</pre>
            </div>
            <div class="feature-card">
                <h4>For Quality</h4>
                <pre>{
  "chunk_size": 10,
  "temperature": 0.7,
  "stream_chunk_size": 1024
}</pre>
            </div>
            <div class="feature-card">
                <h4>For Real-time</h4>
                <pre>{
  "chunk_size": 2,
  "temperature": 0.5,
  "stream_chunk_size": 512
}</pre>
            </div>
        </div>

        <h2>üß™ Testing</h2>
        <h3>Quick Tests</h3>
        <pre># Health check
curl http://localhost:8000/health

# Basic TTS
curl -X POST http://localhost:8000/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "ŸÖÿ±ÿ≠ÿ®ÿß"}'

# Streaming client
open http://localhost:8000/streaming-client</pre>

        <h2>üìù Notes</h2>
        <div class="feature-list">
            <div class="feature-card">
                <h4>Word-Level Processing</h4>
                <p>The API now uses word-level chunking instead of character-level for more natural speech flow and better pronunciation.</p>
            </div>
            <div class="feature-card">
                <h4>Audio Format</h4>
                <p>WAV format (16-bit PCM, 22kHz, mono) with Base64 encoding for WebSocket transmission.</p>
            </div>
            <div class="feature-card">
                <h4>Browser Compatibility</h4>
                <p>Modern browsers with WebSocket and Web Audio API support.</p>
            </div>
        </div>

        <h2>üÜò Support</h2>
        <p>For issues or questions:</p>
        <ol>
            <li>Check the server logs for detailed error messages</li>
            <li>Verify CUDA installation and GPU availability</li>
            <li>Ensure model files are properly downloaded</li>
            <li>Test with the provided HTML streaming client</li>
            <li>Check browser console for WebSocket errors</li>
        </ol>

        <hr>
        <p style="text-align: center; color: #666; margin-top: 40px;">
            <strong>Arabic TTS API</strong> - Powered by XTTS v2 (EGTTS-V0.1)
        </p>
    </div>
</body>
</html>
